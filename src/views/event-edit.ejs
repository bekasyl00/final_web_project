<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>PulseBridge | Edit Event</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;600;700&display=swap" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="/css/styles.css" />
  </head>
  <body>
    <nav class="navbar navbar-expand-lg sticky-top border-bottom">
      <div class="container">
        <a class="navbar-brand brand-mark" href="/">
          <span class="brand-dot"></span>
          PulseBridge
        </a>
        <div class="collapse navbar-collapse">
          <ul class="navbar-nav ms-auto">
            <li class="nav-item"><a class="nav-link" href="/events">Events</a></li>
            <li class="nav-item"><a class="nav-link" href="/organizations">Organizations</a></li>
            <li class="nav-item"><a class="nav-link" href="/posts">Posts</a></li>
            <li class="nav-item"><a class="nav-link" href="/shifts">Shifts</a></li>
            <li class="nav-item"><a class="nav-link" href="/profile">Profile</a></li>
            <li class="nav-item"><a class="nav-link" href="/logout">Logout</a></li>
          </ul>
        </div>
      </div>
    </nav>

    <section class="py-5">
      <div class="container">
        <div class="row g-4 justify-content-center">
          <div class="col-lg-8 fade-up">
            <div class="form-panel">
              <h2 class="section-title">Edit Event</h2>
              <p class="text-muted">Update the event details.</p>
              <% if (error) { %>
                <div class="alert alert-danger"><%= error %></div>
              <% } %>
              <form action="/events/<%= event._id %>" method="POST" novalidate>
                <div class="mb-3">
                  <label class="form-label" for="eventTitle">Title</label>
                  <input id="eventTitle" name="title" type="text" class="form-control <%= errors.title ? 'is-invalid' : '' %>" value="<%= values.title || '' %>" required minlength="3" />
                  <div class="invalid-feedback"><%= errors.title || 'Введите название события.' %></div>
                </div>
                <div class="mb-3">
                  <label class="form-label" for="eventDescription">Description</label>
                  <textarea id="eventDescription" name="description" class="form-control <%= errors.description ? 'is-invalid' : '' %>" rows="4" required minlength="5"><%= values.description || '' %></textarea>
                  <div class="invalid-feedback"><%= errors.description || 'Добавьте описание события.' %></div>
                </div>
                <div class="mb-3">
                  <label class="form-label" for="eventImage">Image URL</label>
                  <input id="eventImage" name="imageUrl" type="url" class="form-control <%= errors.imageUrl ? 'is-invalid' : '' %>" value="<%= values.imageUrl || '' %>" required />
                  <div class="invalid-feedback"><%= errors.imageUrl || 'Укажите ссылку на изображение.' %></div>
                </div>
                <div class="row g-3">
                  <div class="col-md-6">
                    <label class="form-label" for="eventStart">Start Date</label>
                    <input id="eventStart" name="startDate" type="datetime-local" class="form-control <%= errors.startDate ? 'is-invalid' : '' %>" value="<%= values.startDate || '' %>" required />
                    <div class="invalid-feedback"><%= errors.startDate || 'Выберите дату начала.' %></div>
                  </div>
                  <div class="col-md-6">
                    <label class="form-label" for="eventEnd">End Date</label>
                    <input id="eventEnd" name="endDate" type="datetime-local" class="form-control <%= errors.endDate ? 'is-invalid' : '' %>" value="<%= values.endDate || '' %>" />
                    <div class="invalid-feedback"><%= errors.endDate || 'Проверьте дату окончания.' %></div>
                  </div>
                </div>
                <div class="row g-3 mt-1">
                  <div class="col-md-6">
                    <label class="form-label" for="eventLocation">Location</label>
                    <input id="eventLocation" name="location" type="text" class="form-control <%= errors.location ? 'is-invalid' : '' %>" value="<%= values.location || '' %>" />
                    <div class="invalid-feedback"><%= errors.location || 'Введите локацию.' %></div>
                  </div>
                  <div class="col-md-6">
                    <label class="form-label" for="eventOrganization">Organization</label>
                    <select id="eventOrganization" name="organization" class="form-select <%= errors.organization ? 'is-invalid' : '' %>">
                      <option value="">Без организации</option>
                      <% organizations.forEach((org) => { %>
                        <option value="<%= org._id %>" <%= values.organization == org._id.toString() ? 'selected' : '' %>><%= org.name %></option>
                      <% }); %>
                    </select>
                    <div class="invalid-feedback"><%= errors.organization || 'Выберите организацию.' %></div>
                  </div>
                </div>
                <div class="row g-3 mt-1">
                  <div class="col-md-3">
                    <label class="form-label" for="eventCapacity">Capacity</label>
                    <input id="eventCapacity" name="capacity" type="number" class="form-control <%= errors.capacity ? 'is-invalid' : '' %>" value="<%= values.capacity || '' %>" min="1" />
                    <div class="invalid-feedback"><%= errors.capacity || 'Укажите вместимость.' %></div>
                  </div>
                  <div class="col-md-3">
                    <label class="form-label" for="eventStatus">Status</label>
                    <select id="eventStatus" name="status" class="form-select <%= errors.status ? 'is-invalid' : '' %>">
                      <option value="draft" <%= values.status === 'draft' ? 'selected' : '' %>>Draft</option>
                      <option value="published" <%= values.status === 'published' ? 'selected' : '' %>>Published</option>
                      <option value="completed" <%= values.status === 'completed' ? 'selected' : '' %>>Completed</option>
                    </select>
                    <div class="invalid-feedback"><%= errors.status || 'Выберите статус.' %></div>
                  </div>
                </div>
                <button type="submit" class="btn btn-coral w-100 mt-4">Save Changes</button>
              </form>
            </div>
          </div>
        </div>
      </div>
    </section>

    <footer class="footer">
      <div class="container text-center">
        Update event details to keep volunteers informed.
      </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
